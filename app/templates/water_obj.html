{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}

<div id="map" style="width: 100%; height: 700px;"></div>

<div class="btn-group">
    <button type="button" id="allbus" class="btn btn-success">All</button>
    <button type="button" id="others" class="btn btn-primary">Others</button>
    <button type="button" id="cafes" class="btn btn-danger">Cafes</button>
</div>

<div class="table-responsive">
  <table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col"></th>
        <th scope="col">Слой</th>
        <th scope="col">Дата</th>

      </tr>
    </thead>
    <tbody>
      <tr>
        <th scope="row">1</th>
        <td><input class="layer_control" name="layer_control" type="checkbox"  id="S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745"
                   value="S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745"> </td>
        <td>Cell</td>
        <td>Cell</td>

      </tr>

    </tbody>
  </table>
</div>


<script type="text/javascript">
    var mymap = L.map('map').setView([52.46, 82.37], 8);

	L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 18,

	}).addTo(mymap);

	var esri = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
		maxZoom: 18,
		name: "Esri.WorldImagery",

	});
	var layer = L.tileLayer.wms('http://localhost/cgi-bin/mapserv?map=/home/alex/DCORP/SatGis/satgis/static/maps/vectormap.map&ctype=/home/alex/DCORP/SatGis/satgis/rasters/S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745/ndwi.shp', {
		    maxZoom: 18,
            format: 'image/png',
            transparent: true,
            layers: 'NDVI',
            crs: L.CRS.EPSG4326,
            version: '1.1.1',
	    });

	var layers = {};

	var layerGroup = L.layerGroup().addTo(mymap)

	function addLayerToMap(layerId) {
        var layer11 = L.tileLayer.wms('http://localhost/cgi-bin/mapserv?map=/var/www/html/map.map&', {
		    maxZoom: 18,
            format: 'image/png',
            transparent: true,
            layers: 'vdn_0309',
            crs: L.CRS.EPSG4326,
            version: '1.1.1',
	    });

	    var layer = L.tileLayer.wms('http://localhost/cgi-bin/mapserv?map=/home/alex/DCORP/SatGis/satgis/static/maps/vectormap.map&ctype=/home/alex/DCORP/SatGis/satgis/rasters/'+layerId+'/ndwi.shp', {
		    maxZoom: 18,
            format: 'image/png',
            transparent: true,
            layers: 'NDVI',
            crs: L.CRS.EPSG4326,
            version: '1.1.1',
	    });
	    console.log(layer);

	    return layer;

    }
    layers["S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745"] = addLayerToMap($('#S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745').val());
    $(".layer_control").change(function() {
                   layerGroup.addLayer(layers[$(this).val()]);
                   //layerGroup.addLayer($(this).val());

                   var ischecked= $(this).is(':checked');
                   if(!ischecked) {
                   var x_id = L.stamp(layers["S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745"]);
                   var layerObj = layers["S2A_MSIL1C_20180928T054631_N0206_R048_T44UNF_20180929T141745"];
                   layerGroup.removeLayer(x_id);

                   } else {
                   // console.log(layers.test);
                         //layerGroup.addMap(mymap);
                    }
                      //
                });
</script>



<!--{{ request.path }}-->

<!--{% if request.path == '/waterobjects/1-novosibirskoe-vodokhranilishche/' %}-->
    <!--<script src="{% static 'js/map.js' %}" type="text/javascript"></script>-->
<!--{% elif request.path == '/waterobjects/2-oz-krasilovskoe/' %}-->
    <!--<script src="{% static 'js/map-kr.js' %}" type="text/javascript"></script>-->
<!--{% elif request.path == '/waterobjects/3-oz-teletskoe/' %}-->
     <!--<script src="{% static 'js/map-tel.js' %}" type="text/javascript"></script>-->
<!--{% elif request.path == '/waterobjects/None-oz-kulundinsoke/' %}-->
<!--<script src="{% static 'js/map-kl.js' %}" type="text/javascript"></script>-->
<!--{% endif %}-->
{% endblock %}


